import{a as A,b as D,c as v,d as E,e as T}from"./chunk-AAWQSTYN.js";import i from"firebase/app";import"firebase/auth";import{registerPlugin as g,Capacitor as d}from"@capacitor/core";import{Observable as l,throwError as p}from"rxjs";var P=g("CapacitorFirebaseAuth",{web:()=>import("./web-UDJQP7A6.js").then(e=>new e.CapacitorFirebaseAuthWeb)}),c=P,G=(e,n)=>{switch(e){case i.auth.GoogleAuthProvider.PROVIDER_ID:return R();case i.auth.TwitterAuthProvider.PROVIDER_ID:return m();case i.auth.FacebookAuthProvider.PROVIDER_ID:return C();case s:return w();case i.auth.PhoneAuthProvider.PROVIDER_ID:return n?S(n.phone,n.verificationCode):p(new Error("Phone and Verification data must be provided."));default:return p(new Error(`The '${e}' provider was not supported`))}},R=()=>new l(e=>{let n=i.auth.GoogleAuthProvider.PROVIDER_ID;if(d.getPlatform()==="web"){c.link({providerId:n}).then(t=>{e.next({userCredential:t}),e.complete()}).catch(t=>{e.error(t)});return}c.link({providerId:n}).then(t=>{let a=i.auth.GoogleAuthProvider.credential(t.idToken),r=i.app().auth().currentUser;if(!r)return e.error(new Error("No user to link to"));r.linkWithCredential(a).then(o=>{e.next({userCredential:o,result:t}),e.complete()}).catch(o=>{e.error(o)})}).catch(t=>{e.error(t)})}),m=()=>new l(e=>{let n=i.auth.TwitterAuthProvider.PROVIDER_ID;if(d.getPlatform()==="web"){c.link({providerId:n}).then(t=>{e.next({userCredential:t}),e.complete()}).catch(t=>{e.error(t)});return}c.link({providerId:n}).then(t=>{let a=i.auth.TwitterAuthProvider.credential(t.idToken,t.secret),r=i.app().auth().currentUser;if(!r)return e.error(new Error("No user to link to"));r.linkWithCredential(a).then(o=>{e.next({userCredential:o,result:t}),e.complete()}).catch(o=>e.error(o))}).catch(t=>e.error(t))}),C=()=>new l(e=>{let n=i.auth.FacebookAuthProvider.PROVIDER_ID;if(d.getPlatform()==="web"){c.link({providerId:n}).then(t=>{e.next({userCredential:t}),e.complete()}).catch(t=>{e.error(t)});return}c.link({providerId:n}).then(t=>{let a=i.auth.FacebookAuthProvider.credential(t.idToken),r=i.app().auth().currentUser;if(!r)return e.error(new Error("No user to link to"));r.linkWithCredential(a).then(o=>{e.next({userCredential:o,result:t}),e.complete()}).catch(o=>e.error(o))}).catch(t=>e.error(t))}),w=()=>new l(e=>{if(d.getPlatform()==="web"){c.link({providerId:s}).then(n=>{e.next({userCredential:n}),e.complete()}).catch(n=>{e.error(n)});return}c.link({providerId:s}).then(n=>{let{idToken:t,rawNonce:a}=n,r=new i.auth.OAuthProvider("apple.com");r.addScope("email"),r.addScope("name");let o=r.credential({idToken:t,rawNonce:a}),u=i.app().auth().currentUser;if(!u)return e.error(new Error("No user to link to"));u.linkWithCredential(o).then(h=>{e.next({userCredential:h,result:n}),e.complete()}).catch(h=>e.error(h))}).catch(n=>e.error(n))}),S=(e,n)=>new l(t=>{let a=i.auth.PhoneAuthProvider.PROVIDER_ID;if(d.getPlatform()==="web"){c.link({providerId:a}).then(r=>{t.next({userCredential:r}),t.complete()}).catch(r=>{t.error(r)});return}c.link({providerId:a,data:{phone:e,verificationCode:n}}).then(r=>{if(!r.verificationCode)return t.complete();let o=i.auth.PhoneAuthProvider.credential(r.verificationId,r.verificationCode),u=i.app().auth().currentUser;if(!u)return t.error(new Error("No user to link to"));u.linkWithCredential(o).then(h=>{t.next({userCredential:h,result:r}),t.complete()}).catch(h=>t.error(h))}).catch(r=>t.error(r))}),N=(e,n)=>{switch(e){case i.auth.GoogleAuthProvider.PROVIDER_ID:return O();case i.auth.TwitterAuthProvider.PROVIDER_ID:return k();case i.auth.FacebookAuthProvider.PROVIDER_ID:return U();case s:return b();case i.auth.PhoneAuthProvider.PROVIDER_ID:return n?x(n.phone,n.verificationCode):p(new Error("Phone and Verification data must be provided."));default:return p(new Error(`The '${e}' provider was not supported`))}},O=()=>new l(e=>{let n=i.auth.GoogleAuthProvider.PROVIDER_ID;c.signIn({providerId:n}).then(t=>{let a=i.auth.GoogleAuthProvider.credential(t.idToken);i.app().auth().signInWithCredential(a).then(r=>{e.next({userCredential:r,result:t}),e.complete()}).catch(r=>{e.error(r)})}).catch(t=>{e.error(t)})}),k=()=>new l(e=>{let n=i.auth.TwitterAuthProvider.PROVIDER_ID;c.signIn({providerId:n}).then(t=>{let a=i.auth.TwitterAuthProvider.credential(t.idToken,t.secret);i.app().auth().signInWithCredential(a).then(r=>{e.next({userCredential:r,result:t}),e.complete()}).catch(r=>e.error(r))}).catch(t=>e.error(t))}),U=()=>new l(e=>{let n=i.auth.FacebookAuthProvider.PROVIDER_ID;c.signIn({providerId:n}).then(t=>{let a=i.auth.FacebookAuthProvider.credential(t.idToken);i.app().auth().signInWithCredential(a).then(r=>{e.next({userCredential:r,result:t}),e.complete()}).catch(r=>e.error(r))}).catch(t=>e.error(t))}),s="apple.com",b=()=>new l(e=>{c.signIn({providerId:s}).then(n=>{let{idToken:t,rawNonce:a}=n,r=new i.auth.OAuthProvider("apple.com");r.addScope("email"),r.addScope("name");let o=r.credential({idToken:t,rawNonce:a});i.app().auth().signInWithCredential(o).then(u=>{e.next({userCredential:u,result:n}),e.complete()}).catch(u=>e.error(u))}).catch(n=>e.error(n))}),x=(e,n)=>new l(t=>{let a=i.auth.PhoneAuthProvider.PROVIDER_ID;c.signIn({providerId:a,data:{phone:e,verificationCode:n}}).then(r=>{if(!r.verificationCode)return t.complete();let o=i.auth.PhoneAuthProvider.credential(r.verificationId,r.verificationCode);i.app().auth().signInWithCredential(o).then(u=>{t.next({userCredential:u,result:r}),t.complete()}).catch(u=>t.error(u))}).catch(r=>t.error(r))}),W=()=>new l(e=>c.addListener("cfaSignInPhoneOnCodeSent",n=>{e.next(n.verificationId),e.complete()})),L=()=>new l(e=>c.addListener("cfaSignInPhoneOnCodeReceived",n=>{e.next(n),e.complete()})),$=()=>new l(e=>{c.signOut({}).then(()=>{i.app().auth().signOut().then(()=>{e.next(),e.complete()}).catch(n=>e.error(n))})});import{pipe as I}from"rxjs";import{map as f}from"rxjs/operators";var J=()=>I(f(e=>{if(e){let{uid:n,providerId:t,displayName:a,photoURL:r,phoneNumber:o,email:u}=e;return{uid:n,providerId:t,displayName:a,photoURL:r,phoneNumber:o,email:u}}return e})),K=()=>I(f(({userCredential:e})=>{if(e?.user){let{uid:n,providerId:t,displayName:a,photoURL:r,phoneNumber:o,email:u}=e.user;return{uid:n,providerId:t,displayName:a,photoURL:r,phoneNumber:o,email:u}}return null}));export{E as AppleSignInResult,P as CapacitorFirebaseAuth,v as FacebookSignInResult,A as GoogleSignInResult,T as PhoneSignInResult,D as TwitterSignInResult,G as cfaLink,w as cfaLinkApple,C as cfaLinkFacebook,R as cfaLinkGoogle,S as cfaLinkPhone,m as cfaLinkTwitter,N as cfaSignIn,b as cfaSignInApple,s as cfaSignInAppleProvider,U as cfaSignInFacebook,O as cfaSignInGoogle,x as cfaSignInPhone,L as cfaSignInPhoneOnCodeReceived,W as cfaSignInPhoneOnCodeSent,k as cfaSignInTwitter,$ as cfaSignOut,K as mapUserCredentialToUserInfo,J as mapUserToUserInfo};
//# sourceMappingURL=index.js.map