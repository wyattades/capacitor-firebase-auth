"use strict";var de=Object.create;var A=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var le=Object.getPrototypeOf,ge=Object.prototype.hasOwnProperty;var P=(e,t)=>()=>(e&&(t=e(e=0)),t);var y=(e,t)=>{for(var r in t)A(e,r,{get:t[r],enumerable:!0})},E=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of he(t))!ge.call(e,n)&&n!==r&&A(e,n,{get:()=>t[n],enumerable:!(o=pe(t,n))||o.enumerable});return e};var p=(e,t,r)=>(r=e!=null?de(le(e)):{},E(t||!e||!e.__esModule?A(r,"default",{value:e,enumerable:!0}):r,e)),Ie=e=>E(A({},"__esModule",{value:!0}),e);var b,ke,v,S,O,k,C,R=P(()=>{"use strict";b=p(require("firebase/app"),1),ke=require("firebase/auth"),v=class{constructor(t){this.idToken=t}providerId=b.default.auth.GoogleAuthProvider.PROVIDER_ID},S=class{constructor(t,r){this.idToken=t;this.secret=r}providerId=b.default.auth.TwitterAuthProvider.PROVIDER_ID},O=class{constructor(t){this.idToken=t}providerId=b.default.auth.FacebookAuthProvider.PROVIDER_ID},k=class{constructor(t,r,o,n){this.idToken=t;this.rawNonce=r;this.accessToken=o;this.secret=n}providerId=b.default.auth.FacebookAuthProvider.PROVIDER_ID},C=class{constructor(t,r){this.verificationId=t;this.verificationCode=r}providerId=b.default.auth.PhoneAuthProvider.PROVIDER_ID}});var h,Ae,W,V,F=P(()=>{"use strict";h=p(require("firebase/app"),1),Ae=require("firebase/auth");R();W=async()=>{let e=new h.default.auth.OAuthProvider("apple.com");h.default.auth().useDeviceLanguage();let r=(await h.default.auth().signInWithPopup(e))?.credential;return new k(r.idToken,"",r.accessToken,r.secret??"")},V=async()=>{let e=new h.default.auth.FacebookAuthProvider;if(h.default.auth().useDeviceLanguage(),!h.default.auth().currentUser)throw new Error("No user to link to");return await h.default.auth().currentUser.linkWithPopup(e)}});var l,Ue,L,_,G=P(()=>{"use strict";l=p(require("firebase/app"),1),Ue=require("firebase/auth");R();L=async()=>{let e=new l.default.auth.FacebookAuthProvider;l.default.auth().useDeviceLanguage();let r=(await l.default.auth().signInWithPopup(e))?.credential;return new O(r?.accessToken)},_=async()=>{let e=new l.default.auth.FacebookAuthProvider;if(l.default.auth().useDeviceLanguage(),!l.default.auth().currentUser)throw new Error("No user to link to");return await l.default.auth().currentUser.linkWithPopup(e)}});var g,Ve,N,$,j=P(()=>{"use strict";g=p(require("firebase/app"),1),Ve=require("firebase/auth");R();N=async()=>{let e=new g.default.auth.GoogleAuthProvider;g.default.auth().useDeviceLanguage();let r=(await g.default.auth().signInWithPopup(e))?.credential;return new v(r.idToken)},$=async()=>{let e=new g.default.auth.GoogleAuthProvider;if(g.default.auth().useDeviceLanguage(),!g.default.auth().currentUser)throw new Error("No user to link to");return await g.default.auth().currentUser.linkWithPopup(e)}});var D,Ge,H,M,q=P(()=>{"use strict";D=p(require("firebase/app"),1),Ge=require("firebase/auth");R();H=async e=>{D.default.auth().useDeviceLanguage();let t=e.data?.verificationCode,r=new D.default.auth.RecaptchaVerifier(e.data?.container),a=await(await(await D.default.auth().signInWithPhoneNumber(e.data?.phone,r)).confirm(t)).user?.getIdToken();return new C(a,t)},M=async()=>Promise.reject("The phone provider was not implemented for web yet")});var I,He,z,B,J=P(()=>{"use strict";I=p(require("firebase/app"),1),He=require("firebase/auth");R();z=async()=>{let e=new I.default.auth.TwitterAuthProvider;I.default.auth().useDeviceLanguage();let r=(await I.default.auth().signInWithPopup(e))?.credential;return new S(r.accessToken,r.secret)},B=async()=>{let e=new I.default.auth.TwitterAuthProvider;if(I.default.auth().useDeviceLanguage(),!I.default.auth().currentUser)throw new Error("No user to link to");return await I.default.auth().currentUser.linkWithPopup(e)}});var X={};y(X,{CapacitorFirebaseAuthWeb:()=>x});var d,Be,Q,K,x,Y=P(()=>{"use strict";d=p(require("firebase/app"),1),Be=require("firebase/auth"),Q=require("@capacitor/core");F();G();j();q();J();K="apple.com",x=class extends Q.WebPlugin{constructor(){super()}async signIn(t){switch(t.providerId){case K:return W(t);case d.default.auth.GoogleAuthProvider.PROVIDER_ID:return N(t);case d.default.auth.TwitterAuthProvider.PROVIDER_ID:return z(t);case d.default.auth.FacebookAuthProvider.PROVIDER_ID:return L(t);case d.default.auth.PhoneAuthProvider.PROVIDER_ID:return H(t)}return Promise.reject(`The '${t.providerId}' provider was not supported`)}async link(t){switch(t.providerId){case K:return V(t);case d.default.auth.GoogleAuthProvider.PROVIDER_ID:return $(t);case d.default.auth.TwitterAuthProvider.PROVIDER_ID:return B(t);case d.default.auth.FacebookAuthProvider.PROVIDER_ID:return _(t);case d.default.auth.PhoneAuthProvider.PROVIDER_ID:return M(t)}return Promise.reject(`The '${t.providerId}' provider was not supported`)}async signOut(t){return d.default.auth().signOut()}}});var Se={};y(Se,{AppleSignInResult:()=>k,CapacitorFirebaseAuth:()=>Z,FacebookSignInResult:()=>O,GoogleSignInResult:()=>v,PhoneSignInResult:()=>C,TwitterSignInResult:()=>S,cfaLink:()=>fe,cfaLinkApple:()=>ne,cfaLinkFacebook:()=>re,cfaLinkGoogle:()=>ee,cfaLinkPhone:()=>ie,cfaLinkTwitter:()=>te,cfaSignIn:()=>me,cfaSignInApple:()=>ue,cfaSignInAppleProvider:()=>w,cfaSignInFacebook:()=>se,cfaSignInGoogle:()=>oe,cfaSignInPhone:()=>ce,cfaSignInPhoneOnCodeReceived:()=>Re,cfaSignInPhoneOnCodeSent:()=>Pe,cfaSignInTwitter:()=>ae,cfaSignOut:()=>be,mapUserCredentialToUserInfo:()=>ve,mapUserToUserInfo:()=>we});module.exports=Ie(Se);R();var i=p(require("firebase/app"),1),Ze=require("firebase/auth"),f=require("@capacitor/core"),s=require("rxjs"),Z=(0,f.registerPlugin)("CapacitorFirebaseAuth",{web:()=>Promise.resolve().then(()=>(Y(),X)).then(e=>new e.CapacitorFirebaseAuthWeb)}),u=Z,fe=(e,t)=>{switch(e){case i.default.auth.GoogleAuthProvider.PROVIDER_ID:return ee();case i.default.auth.TwitterAuthProvider.PROVIDER_ID:return te();case i.default.auth.FacebookAuthProvider.PROVIDER_ID:return re();case w:return ne();case i.default.auth.PhoneAuthProvider.PROVIDER_ID:return t?ie(t.phone,t.verificationCode):(0,s.throwError)(new Error("Phone and Verification data must be provided."));default:return(0,s.throwError)(new Error(`The '${e}' provider was not supported`))}},ee=()=>new s.Observable(e=>{let t=i.default.auth.GoogleAuthProvider.PROVIDER_ID;if(f.Capacitor.getPlatform()==="web"){u.link({providerId:t}).then(r=>{e.next({userCredential:r}),e.complete()}).catch(r=>{e.error(r)});return}u.link({providerId:t}).then(r=>{let o=i.default.auth.GoogleAuthProvider.credential(r.idToken),n=i.default.app().auth().currentUser;if(!n)return e.error(new Error("No user to link to"));n.linkWithCredential(o).then(a=>{e.next({userCredential:a,result:r}),e.complete()}).catch(a=>{e.error(a)})}).catch(r=>{e.error(r)})}),te=()=>new s.Observable(e=>{let t=i.default.auth.TwitterAuthProvider.PROVIDER_ID;if(f.Capacitor.getPlatform()==="web"){u.link({providerId:t}).then(r=>{e.next({userCredential:r}),e.complete()}).catch(r=>{e.error(r)});return}u.link({providerId:t}).then(r=>{let o=i.default.auth.TwitterAuthProvider.credential(r.idToken,r.secret),n=i.default.app().auth().currentUser;if(!n)return e.error(new Error("No user to link to"));n.linkWithCredential(o).then(a=>{e.next({userCredential:a,result:r}),e.complete()}).catch(a=>e.error(a))}).catch(r=>e.error(r))}),re=()=>new s.Observable(e=>{let t=i.default.auth.FacebookAuthProvider.PROVIDER_ID;if(f.Capacitor.getPlatform()==="web"){u.link({providerId:t}).then(r=>{e.next({userCredential:r}),e.complete()}).catch(r=>{e.error(r)});return}u.link({providerId:t}).then(r=>{let o=i.default.auth.FacebookAuthProvider.credential(r.idToken),n=i.default.app().auth().currentUser;if(!n)return e.error(new Error("No user to link to"));n.linkWithCredential(o).then(a=>{e.next({userCredential:a,result:r}),e.complete()}).catch(a=>e.error(a))}).catch(r=>e.error(r))}),ne=()=>new s.Observable(e=>{if(f.Capacitor.getPlatform()==="web"){u.link({providerId:w}).then(t=>{e.next({userCredential:t}),e.complete()}).catch(t=>{e.error(t)});return}u.link({providerId:w}).then(t=>{let{idToken:r,rawNonce:o}=t,n=new i.default.auth.OAuthProvider("apple.com");n.addScope("email"),n.addScope("name");let a=n.credential({idToken:r,rawNonce:o}),c=i.default.app().auth().currentUser;if(!c)return e.error(new Error("No user to link to"));c.linkWithCredential(a).then(m=>{e.next({userCredential:m,result:t}),e.complete()}).catch(m=>e.error(m))}).catch(t=>e.error(t))}),ie=(e,t)=>new s.Observable(r=>{let o=i.default.auth.PhoneAuthProvider.PROVIDER_ID;if(f.Capacitor.getPlatform()==="web"){u.link({providerId:o}).then(n=>{r.next({userCredential:n}),r.complete()}).catch(n=>{r.error(n)});return}u.link({providerId:o,data:{phone:e,verificationCode:t}}).then(n=>{if(!n.verificationCode)return r.complete();let a=i.default.auth.PhoneAuthProvider.credential(n.verificationId,n.verificationCode),c=i.default.app().auth().currentUser;if(!c)return r.error(new Error("No user to link to"));c.linkWithCredential(a).then(m=>{r.next({userCredential:m,result:n}),r.complete()}).catch(m=>r.error(m))}).catch(n=>r.error(n))}),me=(e,t)=>{switch(e){case i.default.auth.GoogleAuthProvider.PROVIDER_ID:return oe();case i.default.auth.TwitterAuthProvider.PROVIDER_ID:return ae();case i.default.auth.FacebookAuthProvider.PROVIDER_ID:return se();case w:return ue();case i.default.auth.PhoneAuthProvider.PROVIDER_ID:return t?ce(t.phone,t.verificationCode):(0,s.throwError)(new Error("Phone and Verification data must be provided."));default:return(0,s.throwError)(new Error(`The '${e}' provider was not supported`))}},oe=()=>new s.Observable(e=>{let t=i.default.auth.GoogleAuthProvider.PROVIDER_ID;u.signIn({providerId:t}).then(r=>{let o=i.default.auth.GoogleAuthProvider.credential(r.idToken);i.default.app().auth().signInWithCredential(o).then(n=>{e.next({userCredential:n,result:r}),e.complete()}).catch(n=>{e.error(n)})}).catch(r=>{e.error(r)})}),ae=()=>new s.Observable(e=>{let t=i.default.auth.TwitterAuthProvider.PROVIDER_ID;u.signIn({providerId:t}).then(r=>{let o=i.default.auth.TwitterAuthProvider.credential(r.idToken,r.secret);i.default.app().auth().signInWithCredential(o).then(n=>{e.next({userCredential:n,result:r}),e.complete()}).catch(n=>e.error(n))}).catch(r=>e.error(r))}),se=()=>new s.Observable(e=>{let t=i.default.auth.FacebookAuthProvider.PROVIDER_ID;u.signIn({providerId:t}).then(r=>{let o=i.default.auth.FacebookAuthProvider.credential(r.idToken);i.default.app().auth().signInWithCredential(o).then(n=>{e.next({userCredential:n,result:r}),e.complete()}).catch(n=>e.error(n))}).catch(r=>e.error(r))}),w="apple.com",ue=()=>new s.Observable(e=>{u.signIn({providerId:w}).then(t=>{let{idToken:r,rawNonce:o}=t,n=new i.default.auth.OAuthProvider("apple.com");n.addScope("email"),n.addScope("name");let a=n.credential({idToken:r,rawNonce:o});i.default.app().auth().signInWithCredential(a).then(c=>{e.next({userCredential:c,result:t}),e.complete()}).catch(c=>e.error(c))}).catch(t=>e.error(t))}),ce=(e,t)=>new s.Observable(r=>{let o=i.default.auth.PhoneAuthProvider.PROVIDER_ID;u.signIn({providerId:o,data:{phone:e,verificationCode:t}}).then(n=>{if(!n.verificationCode)return r.complete();let a=i.default.auth.PhoneAuthProvider.credential(n.verificationId,n.verificationCode);i.default.app().auth().signInWithCredential(a).then(c=>{r.next({userCredential:c,result:n}),r.complete()}).catch(c=>r.error(c))}).catch(n=>r.error(n))}),Pe=()=>new s.Observable(e=>u.addListener("cfaSignInPhoneOnCodeSent",t=>{e.next(t.verificationId),e.complete()})),Re=()=>new s.Observable(e=>u.addListener("cfaSignInPhoneOnCodeReceived",t=>{e.next(t),e.complete()})),be=()=>new s.Observable(e=>{u.signOut({}).then(()=>{i.default.app().auth().signOut().then(()=>{e.next(),e.complete()}).catch(t=>e.error(t))})});var T=require("rxjs"),U=require("rxjs/operators"),we=()=>(0,T.pipe)((0,U.map)(e=>{if(e){let{uid:t,providerId:r,displayName:o,photoURL:n,phoneNumber:a,email:c}=e;return{uid:t,providerId:r,displayName:o,photoURL:n,phoneNumber:a,email:c}}return e})),ve=()=>(0,T.pipe)((0,U.map)(({userCredential:e})=>{if(e?.user){let{uid:t,providerId:r,displayName:o,photoURL:n,phoneNumber:a,email:c}=e.user;return{uid:t,providerId:r,displayName:o,photoURL:n,phoneNumber:a,email:c}}return null}));0&&(module.exports={AppleSignInResult,CapacitorFirebaseAuth,FacebookSignInResult,GoogleSignInResult,PhoneSignInResult,TwitterSignInResult,cfaLink,cfaLinkApple,cfaLinkFacebook,cfaLinkGoogle,cfaLinkPhone,cfaLinkTwitter,cfaSignIn,cfaSignInApple,cfaSignInAppleProvider,cfaSignInFacebook,cfaSignInGoogle,cfaSignInPhone,cfaSignInPhoneOnCodeReceived,cfaSignInPhoneOnCodeSent,cfaSignInTwitter,cfaSignOut,mapUserCredentialToUserInfo,mapUserToUserInfo});
//# sourceMappingURL=index.cjs.map